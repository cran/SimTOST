<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Bioequivalence Tests for Parallel Trial
Designs: 2 Arms, 3 Endpoints</h1>



<p>In the <code>SimTOST</code> R package, which is specifically designed
for sample size estimation for bioequivalence studies, hypothesis
testing is based on the Two One-Sided Tests (TOST) procedure. <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al.
2015</a>)</span> In TOST, the equivalence test is framed as a comparison
between the the null hypothesis of ‘new product is worse by a clinically
relevant quantity’ and the alternative hypothesis of ‘difference between
products is too small to be clinically relevant’. This vignette focuses
on a parallel design, with 2 arms/treatments and 3 primary
endpoints.</p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In many studies, the aim is to evaluate equivalence across multiple
primary endpoints. The European Medicines Agency (EMA) recommends
demonstrating bioequivalence for both <strong>Area Under the
Curve</strong> (AUC) and <strong>maximum concentration</strong> (Cmax)
when assessing pharmacokinetic properties. This vignette presents
advanced techniques for calculating sample size in parallel trial
designs involving three treatment arms and two endpoints.</p>
<p>As an illustrative example, we consider published data from the
phase-1 trial <a href="https://clinicaltrials.gov/study/NCT01922336#study-overview">NCT01922336</a>.
This trial measured the pharmacokinetics (PK) of SB2 compared to its
EU-sourced reference product (EU_Remicade). The following PK measures
were reported following a single dose of SB2 or its EU reference product
Remicade <span class="citation">(<a href="#ref-shin_randomized_2015">Shin et al. 2015</a>)</span>:</p>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
Primary PK measures between test and reference product. Data represent
arithmetic mean +- standard deviation.
</caption>
<thead>
<tr>
<th style="text-align:left;">
PK measure
</th>
<th style="text-align:left;">
SB2
</th>
<th style="text-align:left;">
Remicade (EU)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AUCinf (<span class="math inline">\(\mu\)</span>g*h/mL)
</td>
<td style="text-align:left;">
38,703 <span class="math inline">\(\pm\)</span> 11,114
</td>
<td style="text-align:left;">
39,360 <span class="math inline">\(\pm\)</span> 12,332
</td>
</tr>
<tr>
<td style="text-align:left;">
AUClast (<span class="math inline">\(\mu\)</span>g*h/mL)
</td>
<td style="text-align:left;">
36,862 <span class="math inline">\(\pm\)</span> 9133
</td>
<td style="text-align:left;">
37,022 <span class="math inline">\(\pm\)</span> 9398
</td>
</tr>
<tr>
<td style="text-align:left;">
Cmax (<span class="math inline">\(\mu\)</span>g/mL)
</td>
<td style="text-align:left;">
127.0 <span class="math inline">\(\pm\)</span> 16.9
</td>
<td style="text-align:left;">
126.2 <span class="math inline">\(\pm\)</span> 17.9
</td>
</tr>
</tbody>
</table>
</div>
<div id="testing-multiple-co-primary-endpoints" class="section level1">
<h1>Testing multiple co-primary endpoints</h1>
<p>The following sections describe strategies for determining the sample
size required for a parallel-group trial aimed at establishing
equivalence across three co-primary endpoints. The Ratio of Means (ROM)
approach will be used to assess equivalence.</p>
<p>A critical step in this process is defining the lower and upper
equivalence boundaries for each endpoint. These boundaries set the
acceptable ROM range within which equivalence is established. For
simplicity, a consistent equivalence range of 0.8 to 1.25 is applied to
all endpoints.</p>
<div id="independent-testing-of-co-primary-endpoints" class="section level2">
<h2>Independent Testing of Co-Primary Endpoints</h2>
<p>A conservative approach to sample size calculation involves testing
each pharmacokinetic (PK) measure independently. This approach assumes
that endpoints are uncorrelated and that equivalence is to be
demonstrated for each endpoint separately. Consequently, the overall
sample size required for the trial is the sum of the sample sizes
calculated for each PK measure separately.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(SimTOST)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Sample size calculation for AUCinf</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>(sim_AUCinf <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">arm_names =</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EU_Remicade&quot;</span>),        <span class="co"># Names of trial arms</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">list_comparator =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>,<span class="st">&quot;EU_Remicade&quot;</span>)),   <span class="co"># Comparator configuration</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">mu_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="dv">38703</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="dv">39360</span>),     <span class="co"># Mean values</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">sigma_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="dv">11114</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="dv">12332</span>),  <span class="co"># Standard deviation values</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">0.80</span>),        <span class="co"># Lower equivalence margin</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">1.25</span>),        <span class="co"># Upper equivalence margin</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>))</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          78</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        90.5</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 88.5 - 92.2</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co"># Sample size calculation for AUClast</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>(sim_AUClast <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>  <span class="at">arm_names =</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EU_Remicade&quot;</span>),        <span class="co"># Names of trial arms</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>  <span class="at">list_comparator =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EU_Remicade&quot;</span>)),  <span class="co"># Comparator configuration</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>  <span class="at">mu_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="dv">36862</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="dv">37022</span>),     <span class="co"># Mean values</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>  <span class="at">sigma_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="dv">9133</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="dv">9398</span>),    <span class="co"># Standard deviation values</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">0.80</span>),        <span class="co"># Lower equivalence margin</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">1.25</span>),        <span class="co"># Upper equivalence margin</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>))</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          54</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        90.4</span></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 88.4 - 92.1</span></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="co"># Sample size calculation for Cmax</span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a>(sim_Cmax <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>  <span class="at">arm_names =</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EU_Remicade&quot;</span>),        <span class="co"># Names of trial arms</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>  <span class="at">list_comparator =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EU_Remicade&quot;</span>)),  <span class="co"># Comparator configuration</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a>  <span class="at">mu_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="fl">127.0</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="fl">126.2</span>),     <span class="co"># Mean values</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a>  <span class="at">sigma_list =</span> <span class="fu">list</span>(<span class="st">&quot;SB2&quot;</span> <span class="ot">=</span> <span class="fl">16.9</span>, <span class="st">&quot;EU_Remicade&quot;</span> <span class="ot">=</span> <span class="fl">17.9</span>),    <span class="co"># Standard deviation values</span></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">0.80</span>),        <span class="co"># Lower equivalence margin</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fl">1.25</span>),        <span class="co"># Upper equivalence margin</span></span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a>))</span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          18</span></span>
<span id="cb1-78"><a href="#cb1-78" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        91.2</span></span>
<span id="cb1-79"><a href="#cb1-79" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 89.2 - 92.8</span></span>
<span id="cb1-80"><a href="#cb1-80" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>When testing each PK measure independently, the total sample size is
78 for AUCinf, 54 for AUClast, and 18 for Cmax. This means that we would
have to enroll 78 + 54 + 18 = 150 patients in order to reject <span class="math inline">\(H_0\)</span>. Note that the significance level of
this combined test is then <span class="math inline">\(0.05^3\)</span>.
For context, the original trial was a randomized, single-blind,
three-arm, parallel-group study conducted in 159 healthy subjects,
slightly more than the 150 patients estimated to be necessary.</p>
</div>
<div id="simultaneous-testing-of-independent-co-primary-endpoints" class="section level2">
<h2>Simultaneous Testing of Independent Co-Primary Endpoints</h2>
<p>This approach focuses on simultaneous testing of PK measures while
assuming independence between endpoints. Unlike the previous approach,
which tested each PK measure independently, this approach integrates
comparisons across multiple endpoints while directly controlling the
overall Type I error rate at a pre-specified level.</p>
<p>The arithmetic means and standard deviations for each endpoint and
treatment arm are defined as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>mu_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">SB2 =</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="dv">38703</span>, <span class="at">AUClast =</span> <span class="dv">36862</span>, <span class="at">Cmax =</span> <span class="fl">127.0</span>),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">EUREF =</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="dv">39360</span>, <span class="at">AUClast =</span> <span class="dv">37022</span>, <span class="at">Cmax =</span> <span class="fl">126.2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>sigma_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">SB2 =</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="dv">11114</span>, <span class="at">AUClast =</span> <span class="dv">9133</span>, <span class="at">Cmax =</span> <span class="fl">16.9</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">EUREF =</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="dv">12332</span>, <span class="at">AUClast =</span> <span class="dv">9398</span>, <span class="at">Cmax =</span> <span class="fl">17.9</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Subsequently, we define the equivalence boundaries:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>list_comparator <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;SB2&quot;</span>, <span class="st">&quot;EUREF&quot;</span>))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>list_lequi.tol <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="fl">0.8</span>, <span class="at">AUClast =</span> <span class="fl">0.8</span>, <span class="at">Cmax =</span> <span class="fl">0.8</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>list_uequi.tol <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="at">AUCinf =</span> <span class="fl">1.25</span>, <span class="at">AUClast =</span> <span class="fl">1.25</span>, <span class="at">Cmax =</span> <span class="fl">1.25</span>))</span></code></pre></div>
<p>Sample size calculation can then be implemented as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(N_ss <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(<span class="at">power =</span> <span class="fl">0.9</span>, <span class="co"># target power</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                    <span class="at">mu_list =</span> mu_list,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                    <span class="at">sigma_list =</span> sigma_list,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                    <span class="at">list_comparator =</span> list_comparator,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                    <span class="at">list_lequi.tol =</span> list_lequi.tol,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                    <span class="at">list_uequi.tol =</span> list_uequi.tol,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                    <span class="at">dtype =</span> <span class="st">&quot;parallel&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                    <span class="at">ctype =</span> <span class="st">&quot;ROM&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>                    <span class="at">vareq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                    <span class="at">lognorm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                    <span class="at">nsim =</span> <span class="dv">1000</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1234</span>))</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;       (multiple co-primary endpoints, m =  3 )</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          84</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;             Achieved Power          90</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 87.9 - 91.8</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>We can inspect the sample size requirements in more detail as
follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>N_ss<span class="sc">$</span>response</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;    n_iter n_drop n_SB2 n_EUREF n_total power power_LCI power_UCI</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;     &lt;num&gt;  &lt;num&gt; &lt;num&gt;   &lt;num&gt;   &lt;num&gt; &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 1:     42      0    42      42      84   0.9 0.8793091 0.9175476</span></span></code></pre></div>
</div>
<div id="simultaneous-testing-of-correlated-co-primary-endpoints" class="section level2">
<h2>Simultaneous Testing of Correlated Co-Primary Endpoints</h2>
<p>Incorporating the correlations between endpoints in sample size
calculations for continuous-valued co-primary endpoints offers
significant advantages <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al. 2015</a>)</span>. Adding more
endpoints typically reduces power if such correlations are not accounted
for. However, by including positive correlations in the calculations,
power can be increased, and the required sample sizes may consequently
be reduced.</p>
<p>For this scenario, we proceed with the same values used previously
but now assume that a correlation exists between endpoints.
Specifically, we set <span class="math inline">\(\rho = 0.6\)</span>,
assuming a common correlation across all endpoints.</p>
<p>If correlations differ between endpoints, they can be specified
individually using a correlation matrix (<code>cor_mat</code>), allowing
for greater flexibility in the analysis.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>(N_mult_corr <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(<span class="at">power =</span> <span class="fl">0.9</span>, <span class="co"># target power</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                           <span class="at">mu_list =</span> mu_list,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                           <span class="at">sigma_list =</span> sigma_list,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                           <span class="at">list_comparator =</span> list_comparator,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                           <span class="at">list_lequi.tol =</span> list_lequi.tol,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                           <span class="at">list_uequi.tol =</span> list_uequi.tol,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                           <span class="at">rho =</span> <span class="fl">0.6</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                           <span class="at">dtype =</span> <span class="st">&quot;parallel&quot;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                           <span class="at">ctype =</span> <span class="st">&quot;ROM&quot;</span>,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                           <span class="at">vareq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                           <span class="at">lognorm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                           <span class="at">nsim =</span> <span class="dv">1000</span>,</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>                           <span class="at">seed =</span> <span class="dv">1234</span>))</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;       (multiple co-primary endpoints, m =  3 )</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          82</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        90.4</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 88.4 - 92.1</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>The required total sample size for this example is 82. This is 2
fewer patients than the scenario in which endpoints are assumed to be
uncorrelated.</p>
</div>
</div>
<div id="multiple-primary" class="section level1">
<h1>Testing multiple primary endpoints</h1>
<div id="simultaneous-testing-of-primary-endpoints" class="section level2">
<h2>Simultaneous Testing of Primary Endpoints</h2>
<p>Imagine that we are interested in demonstrating equivalence for at
least <span class="math inline">\(k\)</span> primary endpoints. Unlike
the previous scenarios, in which equivalence was required for all
endpoints, this scenario requires an adjustment for multiplicity to
control the family-wise error rate. For example, when <span class="math inline">\(k=1\)</span>, we can use the Bonferroni
correction:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>(N_mp_bon <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">mu_list =</span> mu_list,         <span class="co"># List of means</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">sigma_list =</span> sigma_list,   <span class="co"># List of standard deviations</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">list_comparator =</span> list_comparator,  <span class="co"># Comparator configurations</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> list_lequi.tol,    <span class="co"># Lower equivalence boundaries</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> list_uequi.tol,    <span class="co"># Upper equivalence boundaries</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="at">rho =</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="at">dtype =</span> <span class="st">&quot;parallel&quot;</span>,        <span class="co"># Trial design type</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="at">ctype =</span> <span class="st">&quot;ROM&quot;</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="at">vareq =</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  <span class="at">lognorm =</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">c</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="dv">1</span>),          <span class="co"># Demonstrate equivalence for at least 1 endpoint</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">&quot;bon&quot;</span>,            <span class="co"># Bonferroni adjustment method</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>))</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          24</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        90.6</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 88.6 - 92.3</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>As mentioned in <a href="../articles/intropkg.html">the
Introduction</a>, Bonferroni adjustment is often overly conservative,
especially in scenarios with correlated tests. A less restrictive
alternative is the Sidak correction, which accounts for the joint
probability of all tests being non-significant, making it mathematically
less conservative than the Bonferroni method.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>(N_mp_sid <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">mu_list =</span> mu_list,         <span class="co"># List of means</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">sigma_list =</span> sigma_list,   <span class="co"># List of standard deviations</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">list_comparator =</span> list_comparator,  <span class="co"># Comparator configurations</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> list_lequi.tol,    <span class="co"># Lower equivalence boundaries</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> list_uequi.tol,    <span class="co"># Upper equivalence boundaries</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="at">rho =</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="at">dtype =</span> <span class="st">&quot;parallel&quot;</span>,        <span class="co"># Trial design type</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="at">ctype =</span> <span class="st">&quot;ROM&quot;</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="at">vareq =</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="at">lognorm =</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">c</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="dv">1</span>),          <span class="co"># Demonstrate equivalence for at least 1 endpoint</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">&quot;sid&quot;</span>,            <span class="co"># Sidak adjustment method</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>))</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt;     - Multiplicity Correction: Sidak </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.017 </span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          24</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        90.6</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 88.6 - 92.3</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>When <span class="math inline">\(k&gt;1\)</span>, Bonferroni and
Sidak correction methods become increasingly conservative. A more
flexible approach is the <em>k</em>-adjustment, which specifically
accounts for the number of tests and the number of endpoints required
for equivalence.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>(N_mp_k <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="at">mu_list =</span> mu_list,         <span class="co"># List of means</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="at">sigma_list =</span> sigma_list,   <span class="co"># List of standard deviations</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="at">list_comparator =</span> list_comparator,  <span class="co"># Comparator configurations</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="at">list_lequi.tol =</span> list_lequi.tol,    <span class="co"># Lower equivalence boundaries</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="at">list_uequi.tol =</span> list_uequi.tol,    <span class="co"># Upper equivalence boundaries</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="at">rho =</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="at">dtype =</span> <span class="st">&quot;parallel&quot;</span>,        <span class="co"># Trial design type</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="at">ctype =</span> <span class="st">&quot;ROM&quot;</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="at">vareq =</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="at">lognorm =</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">c</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="dv">2</span>),          <span class="co"># Demonstrate equivalence for at least 2 endpoints</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  <span class="at">adjust =</span> <span class="st">&quot;k&quot;</span>,              <span class="co"># Adjustment method</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>))</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt;     - Multiplicity Correction: k-adjustment </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.0333 </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          54</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        91.6</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 89.7 - 93.2</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
</div>
<div id="hierarchical-testing" class="section level2">
<h2>Hierarchical Testing of Endpoints</h2>
<p>Hierarchical testing is a structured approach that allows for a more
nuanced evaluation of endpoints. Unlike a simple setup where at least
<span class="math inline">\(k\)</span> endpoints must pass, hierarchical
testing enforces that some endpoints are more critical and must always
pass before proceeding to secondary endpoints. This ensures that primary
endpoints receive higher priority, while still allowing flexibility in
the evaluation of secondary endpoints.</p>
<p>In this example, the trial follows a hierarchical testing strategy,
with Cmax as the primary endpoint. Equivalence testing begins with Cmax;
if established, the analysis proceeds to the secondary endpoints AUCinf
and AUClast. The trial is considered successful if equivalence holds for
Cmax and at least one (<span class="math inline">\(k \geq 1\)</span>) of
the secondary endpoints.</p>
<p>To implement this advanced hierarchical testing approach in SimTOST,
we:</p>
<ol style="list-style-type: decimal">
<li>Use hierarchical testing by setting
<code>adjust = &quot;seq&quot;</code>.</li>
<li>Define the endpoint hierarchy using the <code>type_y</code>
argument:
<ul>
<li>Primary endpoint: <code>Cmax</code> (coded as 1) is the most
critical endpoint and must always pass.</li>
<li>Secondary endpoints: <code>AUCinf</code> and <code>AUClast</code>
(coded as 2) are less critical and only evaluated if <code>Cmax</code>
passes.</li>
</ul></li>
<li>Set <code>k=1</code>, ensuring that at least one of the two
secondary endpoints (<code>AUCinf</code> or <code>AUClast</code>) must
pass for the trial to be considered successful.</li>
</ol>
<p>The following code demonstrates how to apply hierarchical testing in
SimTOST</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>(N_mp_seq <span class="ot">&lt;-</span> <span class="fu">sampleSize</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">power           =</span> <span class="fl">0.9</span>,                              <span class="co"># Target power</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">alpha           =</span> <span class="fl">0.05</span>,                             <span class="co"># Significance level</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">mu_list         =</span> mu_list,                          <span class="co"># List of means</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">sigma_list      =</span> sigma_list,                       <span class="co"># List of standard deviations</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">list_comparator =</span> list_comparator,                  <span class="co"># Comparator configurations</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">list_lequi.tol  =</span> list_lequi.tol,                   <span class="co"># Lower equivalence boundaries</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">list_uequi.tol  =</span> list_uequi.tol,                   <span class="co"># Upper equivalence boundaries</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">rho             =</span> <span class="fl">0.6</span>,                              <span class="co"># Correlation between endpoints</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="at">dtype           =</span> <span class="st">&quot;parallel&quot;</span>,                       <span class="co"># Trial design type</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="at">ctype           =</span> <span class="st">&quot;ROM&quot;</span>,                            <span class="co"># Test type (Ratio of Means)</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="at">vareq           =</span> <span class="cn">TRUE</span>,                             <span class="co"># Assume equal variances</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">lognorm         =</span> <span class="cn">TRUE</span>,                             <span class="co"># Log-normal distribution assumption</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="at">adjust          =</span> <span class="st">&quot;seq&quot;</span>,                            <span class="co"># Sequential adjustment method</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  <span class="at">type_y          =</span> <span class="fu">c</span>(<span class="st">&quot;AUCinf&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;AUClast&quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Cmax&quot;</span> <span class="ot">=</span> <span class="dv">1</span>), <span class="co"># Endpoint types</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  <span class="at">k               =</span> <span class="fu">c</span>(<span class="st">&quot;EMA&quot;</span> <span class="ot">=</span> <span class="dv">1</span>),                     <span class="co"># Demonstrate equivalence for all 3 endpoints</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  <span class="at">nsim            =</span> <span class="dv">1000</span>,                             <span class="co"># Number of stochastic simulations</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="at">seed            =</span> <span class="dv">1234</span>                              <span class="co"># Random seed for reproducibility</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>))</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; Comparisons:</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt;     - Multiplicity Correction: Sequential </span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.025; 0.025; 0.050 </span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt;                  Parameter       Value</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt;          Total Sample Size          58</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt;             Achieved Power        91.3</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co">#&gt;  Power Confidence Interval 89.3 - 92.9</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>The hierarchical testing strategy ensured that Cmax, the primary
endpoint, had to pass before testing proceeded to the secondary
endpoints AUCinf and AUClast. If Cmax failed, the trial was considered
unsuccessful without evaluating the secondary endpoints. However, if
Cmax passed, at least one of the two secondary endpoints had to
demonstrate equivalence for the trial to be considered successful.</p>
<p>In this particular study design, a total of 58 patients were required
to achieve an overall power of 90%. Previously, 54 patients were
sufficient to demonstrate equivalence for at least two endpoints without
enforcing a hierarchical structure. The increase in sample size by 4
additional patients was necessary to ensure equivalence for Cmax, the
designated primary endpoint. This highlights the impact of hierarchical
testing, where primary endpoints must be adequately powered before
secondary endpoints are considered.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-shin_randomized_2015" class="csl-entry">
Shin, Donghoon, Youngdoe Kim, Yoo Seok Kim, Thomas Körnicke, and Rainard
Fuhr. 2015. <span>“A <span>Randomized</span>, <span>Phase I
Pharmacokinetic Study Comparing SB2</span> and <span>Infliximab
Reference Product</span> (<span>Remicade</span><span></span>) in
<span>Healthy Subjects</span>.”</span> <em>BioDrugs</em> 29 (6): 381–88.
<a href="https://doi.org/10.1007/s40259-015-0150-5">https://doi.org/10.1007/s40259-015-0150-5</a>.
</div>
<div id="ref-sozu_sample_2015" class="csl-entry">
Sozu, Takashi, Tomoyuki Sugimoto, Toshimitsu Hamasaki, and Scott R.
Evans. 2015. <em>Sample <span>Size Determination</span> in
<span>Clinical Trials</span> with <span>Multiple Endpoints</span></em>.
<span>SpringerBriefs</span> in <span>Statistics</span>. Cham: Springer
International Publishing. <a href="https://doi.org/10.1007/978-3-319-22005-5">https://doi.org/10.1007/978-3-319-22005-5</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
